.row
	.large-12.columns
		%ul.breadcrumbs
			%li= link_to 'apps', admin_apps_path
			%li.current= @app.name


.row
	.large-12.columns
		
		.row
			.large-12.columns
				%h2
					= @app.name
				= link_to pluralize(@entity_count, 'Entity'), admin_app_end_entities_path(@app), class: 'button tiny'
				
				= link_to 'Generate CRL', admin_app_generate_crl_path(@app), class: 'button tiny'

		.row
			.large-6.columns
				UUID
			.large-6.columns
			
				.right
					= @app.uuid

		- client_cert = @app.client_certificate

		- if client_cert

			- client_certificate = OpenSSL::X509::Certificate.new client_cert.certificate
		
			.row
				.large-6.columns
					= "Current client cert expires in #{ days_left(@not_after) } (#{@cert.serial.to_s(16)})"
				.large-6.columns
				
					.right
						= link_to 'Renew', '', class: 'button tiny'
						= link_to 'Revoke', admin_app_revoke_client_cert_path(@app), method: :post, data: {confirm: "Revoke certificate (#{client_certificate.serial.to_s(16)})?"}, class: 'button tiny'
					
		- else
		
			.row
				.large-6.columns
					Client Certificate
				.large-6.columns
					.right
						= link_to 'Rekey', admin_app_rekey_client_cert_path(@app), method: :post, class: 'button tiny'
		
		- ca_cert = @app.ca_certificate
					
		- if ca_cert	
				
			- ca_certificate = OpenSSL::X509::Certificate.new ca_cert.certificate	
				
			.row
				.large-6.columns
					= "Current ca cert expires in #{ days_left(@ca_not_after) } (#{@ca_cert.serial.to_s(16)})"
				.large-6.columns
				
					.right
						= link_to 'Renew', '', class: 'button tiny'
						= link_to 'Revoke', admin_app_revoke_ca_cert_path(@app), method: :post, data: {confirm: "Revoke certificate (#{ca_certificate.serial.to_s(16)})?"}, class: 'button tiny'
				
				
		- else
		
			.row
				.large-6.columns
					CA Certificate
				.large-6.columns
					.right
						= link_to 'Rekey', admin_app_rekey_ca_cert_path(@app), method: :post,  class: 'button tiny'

.row
	.large-12.columns


		- if client_cert
			.row
				.large-6.columns
					Client Key
				.large-6.columns
			
					.right
						= link_to 'pem', admin_app_client_key_pem_path(@app), class: 'button tiny'
						= link_to 'der', admin_app_client_key_der_path(@app), class: 'button tiny'
				
			.row
				.large-6.columns
					Client Cert
				.large-6.columns
			
					.right
						= link_to 'pem', admin_app_client_cert_pem_path(@app), class: 'button tiny'
						= link_to 'der', admin_app_client_cert_der_path(@app), class: 'button tiny'

			.row
				.large-6.columns
					p12 Archive
				.large-6.columns	
			
					.right
						= link_to 'der', admin_app_client_pkcs12_der_path(@app), class: 'button tiny'

.row
	.large-12.columns	
	
		- if ca_cert
				
			.row
				.large-6.columns
					CA Cert
				.large-6.columns
			
					.right
						= link_to 'pem', admin_app_ca_cert_pem_path(@app), class: 'button tiny'
						= link_to 'der', admin_app_ca_cert_der_path(@app), class: 'button tiny'

.row
	.large-12.columns
		= link_to 'Back to apps', admin_apps_path, class: 'button tiny'

				